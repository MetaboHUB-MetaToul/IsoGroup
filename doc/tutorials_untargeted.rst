..  _Tutorials:

################################################################################
Tutorials : Untargeted mode
################################################################################

.. seealso:: If you have a question that is not covered in the tutorials, have a look
             at the :ref:`faq`.


.. _First time using IsoGroup:

********************************************************************************
First time using IsoGroup
********************************************************************************

..  _`Input data`:

Input data
================================================================================

IsoGroup takes as input a list of MS features (m/z, retention time, intensity). 
The upstream untargeted extraction of MS features is not handled by IsoGroup,
but can be performed using any MS data processing software such as XCMS, MS-DIAL, or MZMine.
The input data should be provided in a specific format, as detailed below.

..  _`Measurements file`:

Measurements file
--------------------------------------------------------------------------------

**This file contains the MS features of each sample**,
i.e. the mass-to-charge ratios (m/z), retention times, and intensities of the detected peaks.

The measurement file is a TXT file with one row by feature and the following columns:

:id: The feature identifier, as it is referred in the MS data processing software; e.g. "feature_1".
:mz: The mass-to-charge ratio of the feature, as a float; e.g. "123.456".
:rt: The retention time of the feature, as a float, in seconds or minutes; e.g. "12.34".
:sample: The sample name, as it is referred in the MS data processing software; e.g. "Sample_1". The Sample column contains the intensity (or peak area) of the detected feature in the corresponding sample.

:download:`Example file <../isogroup/data/dataset_test.txt>`.

..  _`Clustering parameters`:

Clustering parameters
================================================================================

IsoGroup provides flexible options to adapt to various experimental conditions, such as isotopic tracer, mass accuracy, or data processing quality

:Measurements file: Path to the :ref:`Measurements file`.
:Isotopic tracer: The tracer used for your experiment.
:ppm tolerance: The mass accuracy allowed for the clustering of isotopologues into isotopic clusters, in ppm (parts per million).
:RT window: The retention time window for the clustering of isotopologues into isotopic clusters, in seconds or minutes.

Additional optional parameters:
----------------------------------------------------------------------------------

IsoGroup also provides additional optional parameters to refine the clustering of isotopologues into isotopic clusters:

:Max atoms: The maximum number of tracer atoms expected for any molecule in your dataset. Restricting this parameter reduces the search space and thus the computation time. If ``None`` (default), IsoGroup automatically estimates the maximum number of isotopologues based on the feature m/z and tracer element.
:Keep best candidate: *(bool, default = False)* If set to ``True``, only the best candidate feature is retained for each isotopologue in a cluster. The best candidate is defines as the one **closest to the expected theoretical m/z** (minimizing Î”ppm).
:Keep richest: *(bool, default = True)* When multiple clusters share subsets of features, this option keeps only the **largest (richest)** cluster and removes its strict subsets. If set to ``False``, all clusters are kept, even if they share features.
:Verbose: *(bool, default = False)* If set to ``True``, IsoGroup prints detailed information about the clustering process in the console.


..  _`Output data`:

Output files
================================================================================

Output files are generated in a folder named ``res`` created in the current working directory.

Cluster file
--------------------------------------------------------------------------------

Contains the isotopic clusters formed without prior knowledge based on the tracer element, with the following columns:

:cluster_id: Identifier of the isotopic cluster, as it was generated by IsoGroup.
:feature_id: Identifier of the feature, as it was provided in the :ref:`Measurements file`.
:mz: Mass-to-charge ratio of the feature, as it was provided in the :ref:`Measurements file`.
:rt: Retention time of the feature, as it was provided in the :ref:`Measurements file`.
:isotopologues: The index of the isotopologues of the metabolite corresponding to the cluster.
:sample: Name of the sample, as it was provided in the :ref:`Measurements file`.
:intensity: The intensity of the feature in the sample, as it was provided in the :ref:`Measurements file`.
:isotopologues: The index of the isotopologues of the metabolite corresponding to the cluster.
:inclusters: The cluster identifiers in which the feature is included.
:alsoin: The cluster identifiers of other clusters sharing features with the current cluster.

:download:`Example file <../isogroup/data/res/Dataset_test_XCMS_output_clusters_RT10.0_ppm5.0.tsv>`.

Feature summary file
--------------------------------------------------------------------------------
Contains a summary of the features included or not in isotopic clusters, with the following columns:

:feature_id: Identifier of the feature, as it was provided in the :ref:`Measurements file`.
:mz: Mass-to-charge ratio of the feature, as it was provided in the :ref
:rt: Retention time of the feature, as it was provided in the :ref:`Measurements file`.
:sample: Name of the sample, as it was provided in the :ref:`Measurements file`.
:intensity: The intensity of the feature in the sample, as it was provided in the :
:inclusters: The cluster identifiers in which the feature is included. If the feature is not included in any cluster, the value is "None".
:isotopologues: The index of the isotopologues of the metabolite corresponding to the cluster. If the feature is not included in any cluster, the value is "None".

:download:`Example file <../isogroup/data/res/Dataset_test_XCMS_output_clusters_RT10.0_ppm5.0.features.tsv>`.



